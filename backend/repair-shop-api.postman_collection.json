{
  "info": {
    "_postman_id": "71573a2e-f8a4-47bb-bfdc-f2aae224b674",
    "name": "Repair Shop API",
    "schema": "https://schema.getpostman.com/json/collection/v2.1.0/collection.json",
    "_exporter_id": "11944102"
  },
  "item": [
    {
      "name": "Repair Orders",
      "item": [
        {
          "name": "Create",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "X-Correlation-Id",
                "value": "ro-create"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"customerName\": \"John Doe\",\n  \"vehicleVin\": \"VIN-123\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/repair-orders",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "v1",
                "repair-orders"
              ]
            }
          },
          "response": []
        },
        {
          "name": "List",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "X-Correlation-Id",
                "value": "ro-list"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/v1/repair-orders",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "v1",
                "repair-orders"
              ]
            }
          },
          "response": []
        },
        {
          "name": "Get",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "X-Correlation-Id",
                "value": "ro-get"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/v1/repair-orders/{{repairOrderId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "v1",
                "repair-orders",
                "{{repairOrderId}}"
              ]
            }
          },
          "response": []
        },
        {
          "name": "Update",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "X-Correlation-Id",
                "value": "ro-update"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"version\": 0,\n  \"customerName\": \"John Doe Updated\",\n  \"vehicleVin\": \"VIN-999\",\n  \"status\": \"CLOSED\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/repair-orders/{{repairOrderId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "v1",
                "repair-orders",
                "{{repairOrderId}}"
              ]
            }
          },
          "response": []
        },
        {
          "name": "Delete",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "X-Correlation-Id",
                "value": "ro-delete"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/v1/repair-orders/{{repairOrderId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "v1",
                "repair-orders",
                "{{repairOrderId}}"
              ]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "Invoices",
      "item": [
        {
          "name": "Create",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "X-Correlation-Id",
                "value": "inv-create"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"repairOrderId\": {{repairOrderId}}\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/invoices",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "v1",
                "invoices"
              ]
            }
          },
          "response": []
        },
        {
          "name": "List",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "X-Correlation-Id",
                "value": "inv-list"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/v1/invoices",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "v1",
                "invoices"
              ]
            }
          },
          "response": []
        },
        {
          "name": "List Paginated",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "X-Correlation-Id",
                "value": "inv-list-paginated"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/v1/invoices/paginated?page=0&size=20&sort=id,asc",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "v1",
                "invoices",
                "paginated"
              ],
              "query": [
                {
                  "key": "page",
                  "value": "0"
                },
                {
                  "key": "size",
                  "value": "20"
                },
                {
                  "key": "sort",
                  "value": "id,asc"
                }
              ]
            }
          },
          "response": []
        },
        {
          "name": "Details",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "X-Correlation-Id",
                "value": "inv-details"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/v1/invoices/{{invoiceId}}/details",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "v1",
                "invoices",
                "{{invoiceId}}",
                "details"
              ]
            }
          },
          "response": []
        },
        {
          "name": "Update Status",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "X-Correlation-Id",
                "value": "inv-update"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"version\": 0,\n  \"status\": \"ISSUED\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/invoices/{{invoiceId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "v1",
                "invoices",
                "{{invoiceId}}"
              ]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "Line Items",
      "item": [
        {
          "name": "Create",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "X-Correlation-Id",
                "value": "li-create"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"description\": \"Labor\",\n  \"quantity\": 1,\n  \"unitPriceCents\": 10000\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/invoices/{{invoiceId}}/line-items",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "v1",
                "invoices",
                "{{invoiceId}}",
                "line-items"
              ]
            }
          },
          "response": []
        },
        {
          "name": "List",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "X-Correlation-Id",
                "value": "li-list"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/v1/invoices/{{invoiceId}}/line-items",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "v1",
                "invoices",
                "{{invoiceId}}",
                "line-items"
              ]
            }
          },
          "response": []
        },
        {
          "name": "Update",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "X-Correlation-Id",
                "value": "li-update"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"version\": {{lineItemVersion}},\n  \"description\": \"Labor (updated)\",\n  \"quantity\": 2,\n  \"unitPriceCents\": 12000\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/line-items/{{lineItemId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "v1",
                "line-items",
                "{{lineItemId}}"
              ]
            }
          },
          "response": []
        },
        {
          "name": "Delete",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "X-Correlation-Id",
                "value": "li-delete"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/v1/line-items/{{lineItemId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "v1",
                "line-items",
                "{{lineItemId}}"
              ]
            }
          },
          "response": []
        }
      ]
    },
    {
      "name": "Demo Flow",
      "item": [
        {
          "name": "1 Create RepairOrder",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "var json = pm.response.json();",
                  "pm.collectionVariables.set('repairOrderId', json.id);"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "X-Correlation-Id",
                "value": "demo-1"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"customerName\": \"Jane Doe\",\n  \"vehicleVin\": \"VIN-ABC\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/repair-orders",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "v1",
                "repair-orders"
              ]
            }
          },
          "response": []
        },
        {
          "name": "2 Create Invoice",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "var json = pm.response.json();",
                  "pm.collectionVariables.set('invoiceId', json.id);",
                  "pm.collectionVariables.set('invoiceVersion', json.version);"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "X-Correlation-Id",
                "value": "demo-2"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"repairOrderId\": {{repairOrderId}}\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/invoices",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "v1",
                "invoices"
              ]
            }
          },
          "response": []
        },
        {
          "name": "3 Issue Invoice Without Items (409)",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "X-Correlation-Id",
                "value": "demo-3"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"version\": {{invoiceVersion}},\n  \"status\": \"ISSUED\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/invoices/{{invoiceId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "v1",
                "invoices",
                "{{invoiceId}}"
              ]
            }
          },
          "response": []
        },
        {
          "name": "4 Add LineItem Labor",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "var json = pm.response.json();",
                  "pm.collectionVariables.set('lineItemId', json.id);",
                  "pm.collectionVariables.set('lineItemVersion', json.version);"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "X-Correlation-Id",
                "value": "demo-4"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"description\": \"Labor\",\n  \"quantity\": 1,\n  \"unitPriceCents\": 10000\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/invoices/{{invoiceId}}/line-items",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "v1",
                "invoices",
                "{{invoiceId}}",
                "line-items"
              ]
            }
          },
          "response": []
        },
        {
          "name": "5 Add LineItem Parts",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "var json = pm.response.json();",
                  "pm.collectionVariables.set('lineItemId2', json.id);"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "X-Correlation-Id",
                "value": "demo-5"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"description\": \"Parts\",\n  \"quantity\": 2,\n  \"unitPriceCents\": 2500\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/invoices/{{invoiceId}}/line-items",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "v1",
                "invoices",
                "{{invoiceId}}",
                "line-items"
              ]
            }
          },
          "response": []
        },
        {
          "name": "6 Get Invoice Details",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "X-Correlation-Id",
                "value": "demo-6"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/v1/invoices/{{invoiceId}}/details",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "v1",
                "invoices",
                "{{invoiceId}}",
                "details"
              ]
            }
          },
          "response": []
        },
        {
          "name": "7 Update LineItem",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "var json = pm.response.json();",
                  "pm.collectionVariables.set('lineItemVersion', json.version);"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "X-Correlation-Id",
                "value": "demo-7"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"version\": {{lineItemVersion}},\n  \"description\": \"Labor (updated)\",\n  \"quantity\": 2,\n  \"unitPriceCents\": 12000\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/line-items/{{lineItemId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "v1",
                "line-items",
                "{{lineItemId}}"
              ]
            }
          },
          "response": []
        },
        {
          "name": "8 Optimistic Lock Conflict (409)",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "X-Correlation-Id",
                "value": "demo-8"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"version\": 0,\n  \"description\": \"Should fail\",\n  \"quantity\": 1,\n  \"unitPriceCents\": 99999\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/line-items/{{lineItemId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "v1",
                "line-items",
                "{{lineItemId}}"
              ]
            }
          },
          "response": []
        },
        {
          "name": "9 Delete LineItem",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "X-Correlation-Id",
                "value": "demo-9"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/v1/line-items/{{lineItemId2}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "v1",
                "line-items",
                "{{lineItemId2}}"
              ]
            }
          },
          "response": []
        },
        {
          "name": "10 Issue Invoice",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "X-Correlation-Id",
                "value": "demo-10"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"version\": {{invoiceVersion}},\n  \"status\": \"ISSUED\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/invoices/{{invoiceId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "v1",
                "invoices",
                "{{invoiceId}}"
              ]
            }
          },
          "response": []
        },
        {
          "name": "11 Add LineItem to Issued (409)",
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "X-Correlation-Id",
                "value": "demo-11"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"description\": \"Should fail\",\n  \"quantity\": 1,\n  \"unitPriceCents\": 5000\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/invoices/{{invoiceId}}/line-items",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "v1",
                "invoices",
                "{{invoiceId}}",
                "line-items"
              ]
            }
          },
          "response": []
        },
        {
          "name": "12 Update LineItem on Issued (409)",
          "request": {
            "method": "PUT",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "X-Correlation-Id",
                "value": "demo-12"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"version\": {{lineItemVersion}},\n  \"description\": \"Should fail\",\n  \"quantity\": 1,\n  \"unitPriceCents\": 5000\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/line-items/{{lineItemId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "v1",
                "line-items",
                "{{lineItemId}}"
              ]
            }
          },
          "response": []
        },
        {
          "name": "13 Delete LineItem on Issued (409)",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "X-Correlation-Id",
                "value": "demo-13"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/v1/line-items/{{lineItemId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "v1",
                "line-items",
                "{{lineItemId}}"
              ]
            }
          },
          "response": []
        },
        {
          "name": "14 Delete RepairOrder with Invoice (409)",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "X-Correlation-Id",
                "value": "demo-14"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/v1/repair-orders/{{repairOrderId}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "v1",
                "repair-orders",
                "{{repairOrderId}}"
              ]
            }
          },
          "response": []
        },
        {
          "name": "15 Create Second RepairOrder",
          "event": [
            {
              "listen": "test",
              "script": {
                "exec": [
                  "var json = pm.response.json();",
                  "pm.collectionVariables.set('repairOrderId2', json.id);"
                ],
                "type": "text/javascript"
              }
            }
          ],
          "request": {
            "method": "POST",
            "header": [
              {
                "key": "Content-Type",
                "value": "application/json"
              },
              {
                "key": "X-Correlation-Id",
                "value": "demo-15"
              }
            ],
            "body": {
              "mode": "raw",
              "raw": "{\n  \"customerName\": \"John Smith\",\n  \"vehicleVin\": \"VIN-DEL\"\n}"
            },
            "url": {
              "raw": "{{baseUrl}}/api/v1/repair-orders",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "v1",
                "repair-orders"
              ]
            }
          },
          "response": []
        },
        {
          "name": "16 Delete RepairOrder",
          "request": {
            "method": "DELETE",
            "header": [
              {
                "key": "X-Correlation-Id",
                "value": "demo-16"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/v1/repair-orders/{{repairOrderId2}}",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "v1",
                "repair-orders",
                "{{repairOrderId2}}"
              ]
            }
          },
          "response": []
        },
        {
          "name": "17 List Invoices",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "X-Correlation-Id",
                "value": "demo-17"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/v1/invoices",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "v1",
                "invoices"
              ]
            }
          },
          "response": []
        },
        {
          "name": "18 List Paginated",
          "request": {
            "method": "GET",
            "header": [
              {
                "key": "X-Correlation-Id",
                "value": "inv-list-paginated"
              }
            ],
            "url": {
              "raw": "{{baseUrl}}/api/v1/invoices/paginated?page=0&size=20&sort=id,asc",
              "host": [
                "{{baseUrl}}"
              ],
              "path": [
                "api",
                "v1",
                "invoices",
                "paginated"
              ],
              "query": [
                {
                  "key": "page",
                  "value": "0"
                },
                {
                  "key": "size",
                  "value": "20"
                },
                {
                  "key": "sort",
                  "value": "id,asc"
                }
              ]
            }
          },
          "response": []
        }
      ]
    }
  ],
  "variable": [
    {
      "key": "baseUrl",
      "value": "http://localhost:8080"
    },
    {
      "key": "repairOrderId",
      "value": "1"
    },
    {
      "key": "invoiceId",
      "value": "1"
    },
    {
      "key": "lineItemId",
      "value": "1"
    },
    {
      "key": "lineItemVersion",
      "value": "0"
    },
    {
      "key": "invoiceVersion",
      "value": "0"
    },
    {
      "key": "lineItemId2",
      "value": ""
    },
    {
      "key": "repairOrderId2",
      "value": ""
    }
  ]
}